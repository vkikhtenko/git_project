1. Описание проекта:
Из «Бета-Банка» стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Вам предоставлены исторические данные о поведении клиентов и расторжении договоров с банком. 
Постройте модель с предельно большим значением F1-меры. Чтобы сдать проект успешно, нужно довести метрику до 0.59. Проверьте F1-меру на тестовой выборке самостоятельно.
Дополнительно измеряйте AUC-ROC, сравнивайте её значение с F1-мерой.



2. Описание данных:
Данные находятся в файле по ссылке : 

Признаки:
RowNumber — индекс строки в данных
CustomerId — уникальный идентификатор клиента
Surname — фамилия
CreditScore — кредитный рейтинг
Geography — страна проживания
Gender — пол
Age — возраст
Tenure — сколько лет человек является клиентом банка
Balance — баланс на счёте
NumOfProducts — количество продуктов банка, используемых клиентом
HasCrCard — наличие кредитной карты
IsActiveMember — активность клиента
EstimatedSalary — предполагаемая зарплата

Целевой признак
Exited — факт ухода клиента


3. Выводы по проекту
Начал проект с загрузки данных. Сохранил данные в переменную data.
Далее перешел к анализу данных.

С помощью метода info() определил, что в столбце tenure отсутствует часть данных. Решил проверить, есть ли какая-нибудь связь с другими данными, чтобы заполнить их. Для этого построил гистограммы по каждому признаку. Посмотрел корреляции Пирсона и использовал phik_matrix для определения зависимостей. В итоге зависимости этой переменной с другими данными не обнаружил и решил их удалить. Но вопрос при этом остался открытым: что с ними можно было сделать?

В ходе анализа заметил следующие особенности данных:

 Активных и неактивных пользователей примерно поровну

 Зарплаты распределены подозрительно равномерно

 Очень много пользователей с нулевым балансом

 Тех, кто отказался от услуг банка примерно 20%.

 Подавляющее большинсво пользователей используют один или два продукта банка.

 Медианный возраст в районе 40 лет.

 Длительность пользования услугами банка распределена равномерно среди пользователей, но выбиваются те, кто пользуется меньше года или больше 10 лет

Проверил дисбаланс классов. Соотношение оставшихся клиентов к покившим банк составляет примерно 80 на 20 %.

Разделил выборки на обучающую, валидационную и тестовую в пропорциях 60/20/20. Убрал колонки с фамилией и id из предикторов, так как вряд ли эта информация поможет нам правильно классифицировать пользователей

Преобразовал данные в колонках Geography, Gender в численные переменные с помощью метода OHE. Для того, чтобы не попасть в ловушку фиктивных признаков, передал drop_first=True.

Стандартизировал данные во всех трех выборках

Перешел к исследованию задачи 3.1. Обучил модели логистической регрессии, дерева решений и рандомного леса. Проверил на каждой из них метрики F1, AUC-ROC и построил ROC-кривую. В итоге оказалось, что на данных с дисбалансом лучше всего работает модель рандомного леса. F1 = 0.626, AUC-ROC = 0.863.


Для устанения дисбаланса воспользовался техникой downsampling. Обучил те же модели. Проверил на каждой из них метрики F1, AUC-ROC и построил ROC-кривую. В итоге также оказалось, что лучше всего работает модель рандомного леса. F1 = 0.622, AUC-ROC = 0.864. При этом выросла метрика F1 у логичтической регрессии с 0.330 до 0.514.

Для сравнения воспользовался техникой upsampling. Обучил те же модели. Проверил на каждой из них метрики F1, AUC-ROC и построил ROC-кривую. В итоге также оказалось, что лучше всего работает модель рандомного леса. F1 = 0.649, AUC-ROC = 0.870.

Тестирование моделей рандомного леса с upsampling и downsampling. 4.1. На тестовой выборке модель рандомного леса, обученного на данных с применением техники upsampling показала следующие метрики: F1 = 0.648, AUC-ROC = 0.849

На тестовой выборке модель рандомного леса, обученного на данных с применением техники downsampling показала следующие метрики: F1 = 0.622, AUC-ROC = 0.831

Итого выбираем модель рандомного леса с upsampling из-за более высоких метрик.

Теперь данную модель можно использовать для выявления клиентов, у которых высок риск отказа от услуг банка. Теперь эту информацию мы сможем предпринять меры, препятствующие их уходу.